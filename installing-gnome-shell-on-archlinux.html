<!DOCTYPE html>

<html dir="rtl" lang="fa">

<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width initial-scale=1" />
    <meta name="keywords" content="کامپیوتر، برنامه‌نویسی، پایتون، علم" />
    <meta name="author" content="Mehdi Sadeghi" />
    <meta name="copyright" content="Commons Attribution 4.0 International" />
    <meta name="robot" content="" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge">

    <title>نصب نوم ۳ روی آرچ‌لینوکس</title>
    <meta name="description" content="سکوی انتشار مطالبی در مورد دانش تولید نرم‌افزار و ایده‌ها و علایق شخصی‌ام.
">

    <link rel="stylesheet" href="/assets/css/main.css">
    <link rel="canonical" href="http://mehdix.ir/installing-gnome-shell-on-archlinux.html">
    <link rel="icon" href="/assets/img/favicon.png">

    
     
</head>


<body>
  <div class="container">

    <header class="site-header">

  <div class="wrapper">

    <a class="site-title" href="/">مهدی صادقی</a>
    <small> در مورد نرم‌افزار و ایده‌هایم </small>

    

      <nav class="site-nav">
        <a href="#" class="menu-icon">
          <svg viewBox="0 0 18 15">
            <path fill="#424242" d="M18,1.484c0,0.82-0.665,1.484-1.484,1.484H1.484C0.665,2.969,0,2.304,0,1.484l0,0C0,0.665,0.665,0,1.484,0 h15.031C17.335,0,18,0.665,18,1.484L18,1.484z"/>
            <path fill="#424242" d="M18,7.516C18,8.335,17.335,9,16.516,9H1.484C0.665,9,0,8.335,0,7.516l0,0c0-0.82,0.665-1.484,1.484-1.484 h15.031C17.335,6.031,18,6.696,18,7.516L18,7.516z"/>
            <path fill="#424242" d="M18,13.516C18,14.335,17.335,15,16.516,15H1.484C0.665,15,0,14.335,0,13.516l0,0 c0-0.82,0.665-1.484,1.484-1.484h15.031C17.335,12.031,18,12.696,18,13.516L18,13.516z"/>
          </svg>
        </a>

        <div class="trigger">
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
        </div>
      </nav>
    
    

  </div>

</header>


    <section class="content">

      <div class="page-content">
        <div class="wrapper">
          <div class="post">

  <header class="post-header">
    <h1 class="post-title">نصب نوم ۳ روی آرچ‌لینوکس</h1>
    <p class="post-meta"><span class="date">دوشنبه ۲۷ اردیبهشت ۱۳۹۵</span><!--span> • مهدی صادقی</span--></p>
  </header>

  <article class="post-content">
    <p>در مقاله قبلی نصب آرچ را شرح دادم. حالا می‌خواهم دسکتاپ مورد علاقه‌ام را روی آن نصب کنم یعنی gnome-shell.</p>

<p>اولین قدم ساخت یک کاربر جدید است:</p>

<pre dir="ltr"><code># useradd -m -s /bin/bash mehdi
# passwd mehdi
</code></pre>

<p>برای اینکه این کاربر بتواند با sudo دستور اجرا کند باید آنرا به گروه sudo اضافه کنیم و با دستور visudo تنظیمات sudo را طوری تغییر بدهیم که کاربران عضو گروه sudo بتوانند دستورات روت را اجرا کنند. البته همه چیز با systemd عوض شده است و این روش قدیمی است. ولی من هنوز روش جدید را فرصت نکرده‌ام بخوانم.</p>

<pre dir="ltr"><code># visudo
# find line with # %sudo ALL=... and change it to:
%sudo ALL=(ALL) ALL
# useradd -aG sudo mehdi
</code></pre>

<h1 id="نصب-display-server">نصب Display Server</h1>

<p>قدم بعدی نصب یک Display Server است. من تصمیم گرفتم از سرور جدید Wayland و پیاده‌سازی آن بنام Weston استفاده کنم. Wayland رفته رفته جایگزین Xorg می‌شود. از جایی که Wayland نیاز به <code dir="ltr">Kernel Mode Setting (KVM)</code> دارد باید آنرا فعال کنیم:</p>

<pre dir="ltr"><code># vi /etc/mkinitcpio.conf
# go to line with MODULES=""
# change it to:
MODULES="i915"
</code></pre>

<p>لپ‌تاپ من چیپ گرافیک مجزا ندارد و از پردازشگر گرافیکی اینتل استفاده می‌کند. برای فعال کردن KVM روی اینتل هم کافیست <code dir="ltr">i915</code> را به ماژول‌های کرنل اضافه کنم. ناگفته پیداست که باید ایمیج بوت دوباره ساخته بشود:</p>

<pre dir="ltr"><code># mkinitcpio -p kernel
</code></pre>

<p>حالا بسته‌های لازم را نصب می‌کنیم:</p>

<pre dir="ltr"><code># pacman -S wayland weston xorg-server-wayland
</code></pre>

<p>حالا Wayland را نصب کردیم که چیزی بیشتر از یک کتابخانه نیست. Wetson هم به تنهای به درد ما نمی‌خورد. xorg-sever-wayland هم برای اجرای برنامه‌های xorg از درون Wayland است. چیزی که الان نیاز داریم نصب یک دسکتاپ (نوم) و یک Display Manager برای داشتن یک صفحه لاگین اتوماتیک است.</p>

<h1 id="نصب-display-manager">نصب Display Manager</h1>
<p>اول بسته‌های لازم را نصب می‌کنیم:</p>

<pre dir="ltr"><code># pacman -S gnome gdm
</code></pre>

<p>حالا باید سرویس <code dir="ltr">Gnome Display Manager (gdm)</code> را در systemd فعال کنیم تا با هربار ریبوت خودش اجرا بشود:</p>

<pre dir="ltr"><code># systemctl enable gdm.service
</code></pre>

<p>اگر همه چیز مرتب پیش رفته باشد با یک ریبوت باید به صفحه لاگین گرافیکی هدایت بشویم. از تنظیمات لاگین Gnome on Wayland را انتخاب می‌کنم و لاگین می‌کنم.</p>

<p>باقی کارها را می‌توان به صورت گرافیکی از داخل محیط نوم انجام داد، مثل اضافه کردن چیدمان فارسی برای تایپ کردن و باقی کارها. من بسته‌های ضروری‌ام را همینجا نصب می‌کنم:</p>

<pre dir="ltr"><code># pacman -S gnome-extra gnome-boxes
</code></pre>
<p>این بسته حاوی برنامه‌های رایج برای نوم است و البته ماشین مجازی نوم (باید قابلیت مجازی‌سازی در بایوس فعال باشد در غیر اینصورت خیلی کند خواهد بود). پک‌من سوالی می‌پرسد و من آنهایی را انتخاب می‌کنم که بدردم می‌خورد، بعد سایر برنامه‌های مهم:</p>

<pre dir="ltr"><code># pcaman -S openssh docker pass wget
# systemctl enable docker.service # Make docker service permanent
</code></pre>

<h1 id="فعالسازی-کلید-سختافزاری">فعال‌سازی کلید سخت‌افزاری</h1>
<p>بسیاری امروزه از کلیدهای سخت‌افزاری به عنوان ابزاری برای مکانیزم لاگین دو مرحله‌ای استفاده می‌کنند. مثلا برای لاگین در اکانت گیت‌هاب یا گوگل یا خیلی سرویس‌های دیگر. معروف‌ترین این کلید‌ها Yubikey است. من یک کلید ارزانتر بنام Happlink دارم. برای اینکه این کلیدها را لینوکس بشناسد باید یک قانون جدید به udev اضافه بشود. فایلی که اینجا به قوانین udev اضافه می‌کنیم حاوی شناسه تولیدکنندگان معروف این نوع کلیدهاست:</p>

<pre dir="ltr"><code># this udev file should be used with udev 188 and newer
ACTION!="add|change", GOTO="u2f_end"

# Yubico YubiKey
KERNEL=="hidraw*", SUBSYSTEM=="hidraw", ATTRS{idVendor}=="1050", ATTRS{idProduct}=="0113|0114|0115|0116|0120|0402|0403|0406|0407|0410", TAG+="uaccess"

# Happlink (formerly Plug-Up) Security KEY
KERNEL=="hidraw*", SUBSYSTEM=="hidraw", ATTRS{idVendor}=="2581", ATTRS{idProduct}=="f1d0", TAG+="uaccess"

#  Neowave Keydo and Keydo AES
KERNEL=="hidraw*", SUBSYSTEM=="hidraw", ATTRS{idVendor}=="1e0d", ATTRS{idProduct}=="f1d0|f1ae", TAG+="uaccess"

# HyperSecu HyperFIDO
KERNEL=="hidraw*", SUBSYSTEM=="hidraw", ATTRS{idVendor}=="096e", ATTRS{idProduct}=="0880", TAG+="uaccess"

LABEL="u2f_end"
</code></pre>

<p>مقادیر بالا را در فایلی بنام <code dir="ltr">70-u2f.rules</code> در مسیر <code dir="ltr">/etc/udev/rules.d/</code> ذخیره کرده و udev را ریلود می‌کنیم:</p>

<pre dir="ltr"><code># udevadm control --reload
</code></pre>

<h1 id="فعالسازی-افزونههای-نوم-با-کرومیوم">فعالسازی افزونه‌های نوم با کرومیوم</h1>
<p>برای اینکه بتوان از داخل براوزر افزونه‌های نوم را نصب کرد باید یک پلاگین روی فایرفاکس یا کروم نصب بشود. من اینجا نحوه نصب آنرا روی کروم توضیح می‌دهم. قسمت اول نصب پلاگین کروم است. کروم پلاگینی دارد بنام GNOME Shell Integration که می‌توان آنرا از از استور گوگل براحتی روی کرومیوم نصب کرد. این اکستنشن برای اینکه بتواند پلاگین‌های نوم را کنترل بکند نیاز به یک Connector دارد که باید جداگانه نصب بشود. برای این کار یک پکیج AUR وجود دارد. AUR مخفف Archlinux User Repository است. در AURها همواره یک فایل PKGBUILD وجود دارد که نصب را شرح می‌دهد و فایل‌های لازم حین نصب دانلود و بیلد می‌شوند:</p>

<pre dir="ltr"><code>$ git clone https://aur.archlinux.org/chrome-gnome-shell-git.git
$ cd chrome-gnome-shell-git
$ makepkg -sri
</code></pre>

<p>بعد از این مرحله کافیست به آدرس extensions.gnome.org برویم. حالا باید بتوان افزونه‌ها را فعال و غیرفعال کرد.</p>

<p>با دنبال کردن این دستورات یکه سیستم با دسکتاپ نوم ساختیم. ویکی آرچ بهترین منبع برای یادگیری و تنظیمات بیشتر سیستم است. در صورت علاقه ویکی را برای دستورات و تنظیمات بیشمار ممکن بخوانید.</p>

  </article>
  

  <small id="post-tags">
    
    <i class="icon-tags"></i>
    <a rel="tag" href="/tag/archlinux.html">archlinux</a> &nbsp;
    
    <i class="icon-tags"></i>
    <a rel="tag" href="/tag/%D8%A2%D8%B1%DA%86.html">آرچ</a> &nbsp;
    
    <i class="icon-tags"></i>
    <a rel="tag" href="/tag/%D8%A7%D9%85%D9%86%DB%8C%D8%AA.html">امنیت</a> &nbsp;
    
    <i class="icon-tags"></i>
    <a rel="tag" href="/tag/yubikey.html">yubikey</a> &nbsp;
    
    <i class="icon-tags"></i>
    <a rel="tag" href="/tag/gnome-shell.html">gnome-shell</a> &nbsp;
    
    <i class="icon-tags"></i>
    <a rel="tag" href="/tag/%DA%AF%D9%86%D9%88%D9%85.html">گنوم</a> &nbsp;
    
    <i class="icon-tags"></i>
    <a rel="tag" href="/tag/%D9%86%D9%88%D9%85.html">نوم</a> &nbsp;
    
  </small>

  <div style="border-top:1px dotted;">
    <p>
      
      <a href="/python-zen.html" style="float: left"> python -m this >> </a>
      

      
      <a href="/archlinux_installation_with_lucks_and_lvm.html" style="margin-right:0px;">&#60&#60	 نصب قدم به قدم آرچ‌لینوکس با رمزگزاری</a>
      
    </p>
  </div>

  <!-- An element a visitor can click if they <3 comments! -->
<!--button class="show-comments">نمایش نظرات</button-->

<!-- The empty element required for Disqus to loads comments into -->
<div id="disqus_thread"></div>

<!--script src="//code.jquery.com/jquery-1.11.3.min.js"></script-->
<script src="/assets/js/disqus.js"></script>

<noscript> Please enable JavaScript to view disqus comments. </noscript>

</div>

        </div>
      </div>
    </section>

    <footer class="site-footer">

  <div class="wrapper">
    <div class="footer-col">
    <img id="gravatar" class="circle" src="/assets/img/me.png" alt="">
    </div>
    <h2 class="footer-heading">معرفی</h2>

    <div class="footer-col-wrapper">
      <!--div class="footer-col  footer-col-1">
      <ul class="contact-list">
      <li>مهدی صادقی</li>
      <li><a href="mailto:sadeghi@mehdix.org"> تماس</a></li>
    </ul>
  </div-->

  <div class="footer-col  footer-col-3">

    <p class="text">بچه که بودیم همیشه برای بازی خونه می‌ساختیم. حالا هم نمونه‌اش رو در وب ساختم. اینجا سکوی انتشار مطالبی در مورد دانش تولید نرم‌افزار و ایده‌ها و علایق شخصی‌ام است، بویژه راه‌حل‌های مهندسی که باعث رشد و پیشرفتم شده است و می‌تواند مورد استفاده دیگران هم قرار بگیرد.
</p>
  </div>
  <div class="footer-col  footer-col-2">
    <ul class="social-media-list">
      
      <li>
        <a href="https://github.com/mehdisadeghi">
          <span class="icon  icon--github">
            <svg viewBox="0 0 16 16">
              <path fill="#828282" d="M7.999,0.431c-4.285,0-7.76,3.474-7.76,7.761 c0,3.428,2.223,6.337,5.307,7.363c0.388,0.071,0.53-0.168,0.53-0.374c0-0.184-0.007-0.672-0.01-1.32 c-2.159,0.469-2.614-1.04-2.614-1.04c-0.353-0.896-0.862-1.135-0.862-1.135c-0.705-0.481,0.053-0.472,0.053-0.472 c0.779,0.055,1.189,0.8,1.189,0.8c0.692,1.186,1.816,0.843,2.258,0.645c0.071-0.502,0.271-0.843,0.493-1.037 C4.86,11.425,3.049,10.76,3.049,7.786c0-0.847,0.302-1.54,0.799-2.082C3.768,5.507,3.501,4.718,3.924,3.65 c0,0,0.652-0.209,2.134,0.796C6.677,4.273,7.34,4.187,8,4.184c0.659,0.003,1.323,0.089,1.943,0.261 c1.482-1.004,2.132-0.796,2.132-0.796c0.423,1.068,0.157,1.857,0.077,2.054c0.497,0.542,0.798,1.235,0.798,2.082 c0,2.981-1.814,3.637-3.543,3.829c0.279,0.24,0.527,0.713,0.527,1.437c0,1.037-0.01,1.874-0.01,2.129 c0,0.208,0.14,0.449,0.534,0.373c3.081-1.028,5.302-3.935,5.302-7.362C15.76,3.906,12.285,0.431,7.999,0.431z"/>
            </svg>
          </span>

          <span class="username">پروژه‌ها</span>
        </a>
      </li>
      

      
      <li>
        <a href="https://twitter.com/mehdisadeghii">
          <span class="icon  icon--twitter">
            <svg viewBox="0 0 16 16">
              <path fill="#828282" d="M15.969,3.058c-0.586,0.26-1.217,0.436-1.878,0.515c0.675-0.405,1.194-1.045,1.438-1.809
              c-0.632,0.375-1.332,0.647-2.076,0.793c-0.596-0.636-1.446-1.033-2.387-1.033c-1.806,0-3.27,1.464-3.27,3.27 c0,0.256,0.029,0.506,0.085,0.745C5.163,5.404,2.753,4.102,1.14,2.124C0.859,2.607,0.698,3.168,0.698,3.767 c0,1.134,0.577,2.135,1.455,2.722C1.616,6.472,1.112,6.325,0.671,6.08c0,0.014,0,0.027,0,0.041c0,1.584,1.127,2.906,2.623,3.206 C3.02,9.402,2.731,9.442,2.433,9.442c-0.211,0-0.416-0.021-0.615-0.059c0.416,1.299,1.624,2.245,3.055,2.271 c-1.119,0.877-2.529,1.4-4.061,1.4c-0.264,0-0.524-0.015-0.78-0.046c1.447,0.928,3.166,1.469,5.013,1.469 c6.015,0,9.304-4.983,9.304-9.304c0-0.142-0.003-0.283-0.009-0.423C14.976,4.29,15.531,3.714,15.969,3.058z"/>
            </svg>
          </span>

          <span class="username">توئیت‌ها</span>
        </a>
      </li>
      <li>
        <a href="https://feedburner.google.com/fb/a/mailverify?uri=mehdixir&amp;loc=en_US"><span class="icon icon--feed">
          <img src="/assets/img/feed_gray_50.png" alt="" />
        </span><span class="username">خبرنامه</span></a>
      </li>
      <li>
        <a href="http://feeds.feedburner.com/mehdixir"><span class="icon icon--feed">
          <img src="/assets/img/feed_gray_50.png" alt=""/>
        </span><span class="username">خوراک</span></a>
      </li>
      <li>
        <span class="icon"><a href="http://validator.w3.org/feed/check.cgi?url=http%3A//mehdix.ir/feed.xml"><img src=/assets/img/valid-atom.png alt="[Valid Atom 1.0]" title="Validate my Atom 1.0 feed" /></a></span>
        <span class="icon"><a href="https://app.wercker.com/project/bykey/7cdfaf1d4ea865468f4965954ed95247"><img src="https://app.wercker.com/status/7cdfaf1d4ea865468f4965954ed95247/s" alt="Build Status" title="wercker status" /></a>
        </span>
      </li>
      
    </ul>
  </div>
</div>
<div id="license" class="textwidget">
<a rel="license" href="http://creativecommons.org/licenses/by/4.0/deed.fa"><img alt="مجوز کریتیو کامنز" style="border-width:0" src="https://i.creativecommons.org/l/by/4.0/80x15.png" /></a><br />
مطالب این وبلاگ تحت مجوز
 <a rel="license" href="http://creativecommons.org/licenses/by/4.0/deed.fa"> 
کریتیو کامنز اتریبیوشن ۴.۰ اینترنشنال </a>قرار دارد.
</div>

</div>
<div  class="center">
  <small style="color:gray">Site generated on Sun, 29 Jan 2017 16:42:51 +0100</small>
</div>
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-57282325-1', 'auto');
  ga('send', 'pageview');

</script>

</footer>


  </div>

<script src="/assets/js/main.js"></script>

</body>

</html>
